{"pageProps":{"markdoc":{"content":[{"$$mdtype":"Tag","name":"table","attributes":{},"children":[{"$$mdtype":"Tag","name":"thead","attributes":{},"children":[]},{"$$mdtype":"Tag","name":"tbody","attributes":{},"children":[{"$$mdtype":"Tag","name":"tr","attributes":{},"children":[{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"strong","attributes":{},"children":["Complexity"]}]},{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"ul","attributes":{},"children":[{"$$mdtype":"Tag","name":"li","attributes":{},"children":["Medium"]}]}]}]},{"$$mdtype":"Tag","name":"tr","attributes":{},"children":[{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"strong","attributes":{},"children":["Pros"]}]},{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"ul","attributes":{},"children":[{"$$mdtype":"Tag","name":"li","attributes":{},"children":["Mitigates replay attacks by adding a signed timestamp to the webhook request"]}]}]}]},{"$$mdtype":"Tag","name":"tr","attributes":{},"children":[{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"strong","attributes":{},"children":["Caveats"]}]},{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"ul","attributes":{},"children":[{"$$mdtype":"Tag","name":"li","attributes":{},"children":["Requires webhook provider and consumers to have clock in sync (or close to)"]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":["Requires alignment in time format — i.e. UNIX timestamp or RFC 3339 and time zones for the proper validation"]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":["Timestamps can be sent in the same header as hash signatures or in a dedicated timestamp header"]}]}]}]},{"$$mdtype":"Tag","name":"tr","attributes":{},"children":[{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"strong","attributes":{},"children":["Examples"]}]},{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"ul","attributes":{},"children":[{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"a","attributes":{"href":"https://developer.8x8.com/contactcenter/docs/verify-webhook-callbacks"},"children":["8x8"]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"a","attributes":{"href":"https://developer.calendly.com/api-docs/ZG9jOjM2MzE2MDM4-webhook-signatures"},"children":["Calendly"]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"a","attributes":{"href":"https://api.slack.com/authentication/verifying-requests-from-slack"},"children":["Slack"]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"a","attributes":{"href":"https://developer.paypal.com/api/rest/webhooks/#link-eventheadervalidation"},"children":["PayPal"]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"a","attributes":{"href":"https://developer.zendesk.com/documentation/event-connectors/webhooks/verifying/"},"children":["Zendesk"]}]}]}]}]}]}]},{"$$mdtype":"Tag","name":"hr","attributes":{},"children":[]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["Many webhook vendors take advantage of hashing and encryption to add security beyond authentication and message integrity. By combining message integrity with timestamps, providers offer a way to validate when a call is made and mitigate replay attacks. In our research, We saw the use of timestamps in conjunction with HMAC — i.e. ",{"$$mdtype":"Tag","name":"a","attributes":{"href":"https://developer.calendly.com/api-docs/ZG9jOjM2MzE2MDM4-webhook-signatures"},"children":["Calendly"]},", Assymetric Encryption - ",{"$$mdtype":"Tag","name":"a","attributes":{"href":"https://developer.paypal.com/api/rest/webhooks/#link-eventheadervalidation"},"children":["PayPal"]},", and JWT/JWK/OAuth — ",{"$$mdtype":"Tag","name":"a","attributes":{"href":"https://developer.8x8.com/contactcenter/docs/verify-webhook-callbacks"},"children":["8x8"]},". Timestamp generation and validation takes the following steps:"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["On webhook requests, the provider:"]},{"$$mdtype":"Tag","name":"ol","attributes":{},"children":[{"$$mdtype":"Tag","name":"li","attributes":{},"children":["Concatenates the timestamp of when the request is created with the webhook payload"]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":["Signs the concatenated value"]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":["Sends both the encoded signature and the timestamp to the webhook request"]}]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["The webhook listener receives the request and:"]},{"$$mdtype":"Tag","name":"ol","attributes":{},"children":[{"$$mdtype":"Tag","name":"li","attributes":{},"children":["Extracts the timestamp — i.e. from the request header — and validates if the timestamp is within an acceptable timeframe (i.e., 3-5 minutes)."]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":["If the timestamp is valid, repeat the same steps from the webhook provider to sign the timestamp+request body and compare the results with the signature sent. If the result matches, the request is considered legit. If not, the request is not authenticated and its contents or timestamp are tampered."]}]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["To ensure the timestamp validation works, you must keep your listener clock in sync with the webhook provider. The use of an NTP server should address this concern."]}],"frontmatter":{"title":"Replay prevention","description":"Webhook security Replay prevention"},"file":{"path":"/security/replay-prevention.md"}}},"__N_SSG":true}