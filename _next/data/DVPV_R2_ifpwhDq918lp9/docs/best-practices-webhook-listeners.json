{"pageProps":{"markdoc":{"content":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":["In addition to using a good webhook provider and implementation, you can take the following steps to improve your webhook security:"]},{"$$mdtype":"Tag","name":"ul","attributes":{},"children":[{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":[{"$$mdtype":"Tag","name":"strong","attributes":{},"children":["Use HTTPS on the listener with a strong cipher suite"]},": First and foremost, do not operate in clear text (seriously, don't!). Most webhooks don't provide any control to encrypt your messages. This recommendation is even more critical in webhooks with  Basic Authentication and Shared Secret. Use HTTPS with a strong cipher suite to mitigate the man-in-the-middle."]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":[{"$$mdtype":"Tag","name":"strong","attributes":{},"children":["Review the webhook documentation and ensure you're implementing all the security features offered:"]}," in webhook communications, the authentication, message integrity validation, and replay prevention validation and enforcement happen on the webhook listener. Therefore, you should read, understand, and implement the security controls made available by your provider."]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":[{"$$mdtype":"Tag","name":"strong","attributes":{},"children":["Restrict who can send you webhook requests based on the IP"]},": Some services — i.e. ",{"$$mdtype":"Tag","name":"a","attributes":{"href":"https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/about-githubs-ip-addresses"},"children":["Github"]}," — provide a public list of IPs used in their service to send you webhook notifications. You can use this list to implement network restrictions and ensure only the webhook service is sending the notification. Note that this may not be possible if the webhook service does not provide a list of their origin IPs."]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":[{"$$mdtype":"Tag","name":"strong","attributes":{},"children":["Storing secrets"]},": Credentials and shared secrets should be treated as confidential information and handled like private keys (handled secretly and stored appropriately both on the webhook service and listener in production usage)."]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":[{"$$mdtype":"Tag","name":"strong","attributes":{},"children":["Segmenting secrets:"]}," Some services — like DocuSign — will let you adopt a unique secret for each webhook listener. This allows you to segment secrets and reduce the likelihood of compromise."]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":[{"$$mdtype":"Tag","name":"strong","attributes":{},"children":["Rotating secrets:"]}," In addition to segmentation, you can also change secrets at a regular intervals or after important events — i.e. when an important employee leaves the organization — to mitigate risk if the secret is compromised."]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":[{"$$mdtype":"Tag","name":"strong","attributes":{},"children":["Use strong signature algorithms"]},": Whenever possible, use the strongest hashing algorithms available with the webhook signature. HMAC-SHA256 is the most popularly used hash signature."]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":[{"$$mdtype":"Tag","name":"strong","attributes":{},"children":["Call back the service:"]}," An interesting method to validate if a webhook request is legitimate is to call the service that sent the webook from a different channel such as their REST API to confirm said event happened. Some services — i.e. Atlassian Jira — will include an API endpoint in the webhook body to facilitate the validation. However, this approach impacts performance and time to value."]}]}]},{"$$mdtype":"Tag","name":"Fence","attributes":{"language":"mermaid"},"children":["sequenceDiagram\n   autonumber\n   participant Service API\n   participant Webhook Service\n   participant Listening App\n   Note left of Webhook Service: Create webhook message\n   Note left of Webhook Service: Add Shared Secret\n   Webhook Service->>+Listening App: Send Webhook notification\n   Note right of Listening App: Validate Shared Secret\n   Note right of Listening App: Get id\n   Listening App->>+Service API: Send API call with id\n   Note left of Service API: Process request\n   Service API-->>-Listening App: Retrieve response\n   Note right of Listening App: Process webhook call\n   Listening App-->>-Webhook Service: Return response\n"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[{"$$mdtype":"Tag","name":"em","attributes":{},"children":["Webhook notification with API callback"]}]}],"frontmatter":{"title":"Best Practices for Webhook Listeners","description":"Security Best Practices for Webhook Listeners"},"file":{"path":"/docs/best-practices-webhook-listeners.md"}}},"__N_SSG":true}