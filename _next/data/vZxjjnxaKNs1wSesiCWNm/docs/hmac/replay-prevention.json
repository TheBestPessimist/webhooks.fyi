{"pageProps":{"markdoc":{"content":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":["Another interesting feature of HMAC is that signatures can be extended beyond the request body to include other pieces of information. By combining HMAC with timestamps, providers — such as ",{"$$mdtype":"Tag","name":"a","attributes":{"href":"https://developer.calendly.com/api-docs/ZG9jOjM2MzE2MDM4-webhook-signatures"},"children":["Calendly"]},", ",{"$$mdtype":"Tag","name":"a","attributes":{"href":"https://api.slack.com/authentication/verifying-requests-from-slack"},"children":["Slack"]},", and ",{"$$mdtype":"Tag","name":"a","attributes":{"href":"https://developer.zendesk.com/documentation/event-connectors/webhooks/verifying/"},"children":["Zendesk"]}," — offer a way to mitigate replay attacks. HMAC can be used with timestamps as follows:"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["On webhook requests, the provider:"]},{"$$mdtype":"Tag","name":"ol","attributes":{},"children":[{"$$mdtype":"Tag","name":"li","attributes":{},"children":["Concatenates the timestamp of when the request is created with the webhook message."]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":["Signs the concatenated value with the secret key"]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":["Adds both the encoded signature and the timestamp to the webhook request as header variables."]}]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["The webhook listener receives the request and:"]},{"$$mdtype":"Tag","name":"ol","attributes":{},"children":[{"$$mdtype":"Tag","name":"li","attributes":{},"children":["Extracts the timestamp from the request header and validates if the timestamp is within an acceptable timeframe (i.e., 3-5 minutes)."]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":["If the timestamp is valid, repeat the same steps from the webhook provider to sign the timestamp+request body and compare the results with the signature sent via the request header. If the result matches, the request is considered legit. If not, the request is not authenticated and its contents or timestamp are tampered."]}]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["To ensure the timestamp validation works, you must keep your listener clock in sync with the webhook provider. The use of an NTP server should address this concern."]}],"frontmatter":{"title":"Replay prevention'","description":"Webhook security Replay prevention"},"file":{"path":"/docs/hmac/replay-prevention.md"}}},"__N_SSG":true}